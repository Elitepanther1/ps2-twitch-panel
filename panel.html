<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Planetside 2 Stats</title>

  <style>
    body {
      margin: 0;
      background: transparent;
      font-family: Arial, Helvetica, sans-serif;
      color: white;
    }

    .panel {
      width: 320px;
      background: rgba(15, 15, 20, 0.95);
      border-radius: 10px;
      padding: 12px;
      box-shadow: 0 0 15px rgba(0,0,0,0.6);
      border-left: 6px solid transparent;
    }

    .header {
      display: flex;
      align-items: center;
      gap: 10px;
      border-bottom: 1px solid rgba(255,255,255,0.2);
      padding-bottom: 8px;
      margin-bottom: 8px;
    }

    .header img {
      width: 48px;
      height: 48px;
    }

    .header h1 {
      font-size: 16px;
      margin: 0;
    }

    .header span {
      font-size: 12px;
      opacity: 0.8;
    }

    .stats div {
      display: flex;
      justify-content: space-between;
      padding: 4px 0;
      font-size: 14px;
    }
  </style>
</head>

<body>
  <div class="panel">
    <div class="header">
      <img id="factionLogo" />
      <div>
        <h1 id="charName">Loading...</h1>
        <span id="battleRank"></span>
      </div>
    </div>

    <div class="stats">
      <div><span>Kills</span><b id="kills">0</b></div>
      <div><span>Deaths</span><b id="deaths">0</b></div>
      <div><span>K/D</span><b id="kd">0.00</b></div>
      <div><span>Headshots</span><b id="headshots">0</b></div>
      <div><span>Playtime</span><b id="playtime">0 hrs</b></div>
    </div>
  </div>

  <script>
    const CHARACTER_NAME = "Hellbirdgunner";
    const API_URL =
      "https://ps2-stats-api.vercel.app/api/character?name=" + CHARACTER_NAME;

    const FACTIONS = {
      1: {
        name: "Vanu Sovereignty",
        color: "#7B3FE4",
        logo: "https://raw.githubusercontent.com/cooltrain7/Planetside-2-API-Images/master/factions/vs.png"
      },
      2: {
        name: "New Conglomerate",
        color: "#1F6AE1",
        logo: "https://raw.githubusercontent.com/cooltrain7/Planetside-2-API-Images/master/factions/nc.png"
      },
      3: {
        name: "Terran Republic",
        color: "#C62828",
        logo: "https://raw.githubusercontent.com/cooltrain7/Planetside-2-API-Images/master/factions/tr.png"
      }
    };

    async function loadStats() {
      try {
        const response = await fetch(API_URL);
        const data = await response.json();

        if (!data || data.error) throw new Error("API error");

        const stats = data.stats || {};

        const kills = stats.kills || 0;
        const deaths = stats.deaths || 0;
        const headshots = stats.headshots || 0;
        const playtimeSeconds = stats.playtime || 0;

        const kd = deaths > 0 ? (kills / deaths).toFixed(2) : "âˆž";
        const playtimeHours = (playtimeSeconds / 3600).toFixed(1);

        // BASIC STATS
        document.getElementById("charName").textContent = data.name;
        document.getElementById("battleRank").textContent =
          "BR " + data.battleRank;
        document.getElementById("kills").textContent = kills.toLocaleString();
        document.getElementById("deaths").textContent = deaths.toLocaleString();
        document.getElementById("kd").textContent = kd;
        document.getElementById("headshots").textContent =
          headshots.toLocaleString();
        document.getElementById("playtime").textContent =
          playtimeHours + " hrs";

        // FACTION STYLING
        const faction = FACTIONS[data.factionId];
        if (faction) {
          document.querySelector(".panel").style.borderLeft =
            "6px solid " + faction.color;
          document.getElementById("factionLogo").src = faction.logo;
        }

      } catch (err) {
        console.error(err);
        document.querySelector(".panel").innerHTML =
          "<div style='text-align:center;color:#f87171;'>Stats unavailable</div>";
      }
    }

    loadStats();
    setInterval(loadStats, 60000);
  </script>
</body>
</html>

